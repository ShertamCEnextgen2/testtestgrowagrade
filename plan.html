<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="plan.css">
  <title>‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
</head>
<body>
  <div class="container">
    <h1>üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
    
    <div class="calendar-section">
      <div class="calendar-controls">
        <button id="btnPrevMonth">‚óÄ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>
        <div id="currentMonthYear"></div>
        <button id="btnNextMonth">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ñ∂</button>
      </div>
      
      <div class="calendar-header">
        <div>‡∏≠‡∏≤</div>
        <div>‡∏à</div>
        <div>‡∏≠</div>
        <div>‡∏û</div>
        <div>‡∏û‡∏§</div>
        <div>‡∏®</div>
        <div>‡∏™</div>
      </div>
      
      <div id="calendar"></div>
    </div>

    <div class="activity-section">
      <h3>üìù ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="selectedDateDisplay">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</span></h3>
      <ul id="activityList">
        <div class="empty-state">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>
      </ul>
      
      <div class="input-section">
        <input type="text" id="newActivity" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà..." />
        <button id="btnAddActivity">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
      </div>
      
      <div id="progressBar">
        <div id="progressBarFill"></div>
      </div>
      <div class="progress-text" id="progressText">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: 0%</div>
    </div>
  </div>

  <script>
    let currentYear, currentMonth, selectedDate = null;
    let activities = {}; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥

    document.addEventListener('DOMContentLoaded', () => {
      const today = new Date();
      currentYear = today.getFullYear();
      currentMonth = today.getMonth();
      
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
      generateSampleActivities();
      
      buildCalendar(currentYear, currentMonth);

      document.getElementById('btnPrevMonth').onclick = () => {
        if (--currentMonth < 0) { 
          currentMonth = 11; 
          currentYear--; 
        }
        buildCalendar(currentYear, currentMonth);
      };
      
      document.getElementById('btnNextMonth').onclick = () => {
        if (++currentMonth > 11) { 
          currentMonth = 0; 
          currentYear++; 
        }
        buildCalendar(currentYear, currentMonth);
      };

      document.getElementById('btnAddActivity').onclick = addActivityHandler;
      document.getElementById('newActivity').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addActivityHandler();
      });
    });

    function generateSampleActivities() {
      const today = new Date();
      
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 30 ‡∏ß‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤
      for (let i = 0; i < 30; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() + i);
        const dateStr = formatDate(date);
        
        activities[dateStr] = [];
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        activities[dateStr].push({ text: '‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤', done: false });
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô
        if (i % 3 === 0) {
          activities[dateStr].push({ text: '‡∏ù‡∏∂‡∏Å‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', done: false });
        }
        if (i % 5 === 0) {
          activities[dateStr].push({ text: '‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©', done: false });
        }
        if (i % 7 === 0) {
          activities[dateStr].push({ text: '‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', done: false });
        }
        
        // ‡∏ß‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
        const dayOfWeek = date.getDay();
        if (dayOfWeek === 0) { // ‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå
          activities[dateStr].push({ text: '‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå', done: false });
        }
        if (dayOfWeek === 5) { // ‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå
          activities[dateStr].push({ text: '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏´‡∏ô‡πâ‡∏≤', done: false });
        }
      }
    }

    function buildCalendar(year, month) {
      const calendar = document.getElementById('calendar');
      calendar.innerHTML = '';
      
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const monthNames = [
        '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
        '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
      ];
      
      document.getElementById('currentMonthYear').textContent = `${monthNames[month]} ${year}`;

      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1
      for (let i = 0; i < firstDay; i++) {
        calendar.appendChild(document.createElement('div'));
      }

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      for (let d = 1; d <= daysInMonth; d++) {
        const dateObj = new Date(year, month, d);
        const dateStr = formatDate(dateObj);
        const cell = document.createElement('div');
        
        cell.classList.add('day');
        cell.dataset.date = dateStr;
        cell.textContent = d;

        // ‡πÄ‡∏ô‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        if (isSameDate(dateObj, new Date())) {
          cell.classList.add('today');
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏∏‡∏î‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
        if (activities[dateStr] && activities[dateStr].length > 0) {
          cell.classList.add('has-activity');
        }

        cell.onclick = () => selectDate(dateObj);
        calendar.appendChild(cell);
      }
    }

    function selectDate(date) {
      selectedDate = date;
      const dateStr = formatDate(date);
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
      const thaiDate = date.toLocaleDateString('th-TH', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
      });
      document.getElementById('selectedDateDisplay').textContent = thaiDate;
      
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏µ‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
      document.querySelectorAll('#calendar .clicked-day').forEach(el => {
        el.classList.remove('clicked-day');
      });
      
      const selectedCell = document.querySelector(`#calendar .day[data-date="${dateStr}"]`);
      if (selectedCell) selectedCell.classList.add('clicked-day');
      
      renderActivitiesForDate(dateStr);
    }

    function formatDate(date) {
      const y = date.getFullYear();
      const m = (date.getMonth() + 1).toString().padStart(2, '0');
      const d = date.getDate().toString().padStart(2, '0');
      return `${y}-${m}-${d}`;
    }

    function isSameDate(d1, d2) {
      return d1.getFullYear() === d2.getFullYear()
          && d1.getMonth() === d2.getMonth()
          && d1.getDate() === d2.getDate();
    }

    function renderActivitiesForDate(dateStr) {
      const list = document.getElementById('activityList');
      list.innerHTML = '';
      
      const dayActivities = activities[dateStr] || [];
      
      if (dayActivities.length === 0) {
        list.innerHTML = '<div class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>';
      } else {
        dayActivities.forEach((item, index) => {
          const li = document.createElement('li');
          
          const taskContent = document.createElement('div');
          taskContent.classList.add('task-content');
          
          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.checked = item.done;
          checkbox.onchange = () => {
            item.done = checkbox.checked;
            span.className = item.done ? 'completed' : '';
            updateProgressBar(dayActivities);
            updateCalendarView();
          };
          
          const span = document.createElement('span');
          span.textContent = item.text;
          span.className = item.done ? 'completed' : '';
          
          const delBtn = document.createElement('button');
          delBtn.textContent = '‡∏•‡∏ö';
          delBtn.classList.add('delete-btn');
          delBtn.onclick = () => {
            dayActivities.splice(index, 1);
            renderActivitiesForDate(dateStr);
            updateCalendarView();
          };

          taskContent.appendChild(checkbox);
          taskContent.appendChild(span);
          li.appendChild(taskContent);
          li.appendChild(delBtn);
          list.appendChild(li);
        });
      }
      
      updateProgressBar(dayActivities);
    }

    function addActivityHandler() {
      const input = document.getElementById('newActivity');
      const text = input.value.trim();
      
      if (!selectedDate || !text) {
        if (!selectedDate) {
          alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô');
        }
        return;
      }
      
      const dateStr = formatDate(selectedDate);
      
      if (!activities[dateStr]) {
        activities[dateStr] = [];
      }
      
      activities[dateStr].push({ text, done: false });
      input.value = '';
      renderActivitiesForDate(dateStr);
      updateCalendarView();
    }

    function updateProgressBar(dayActivities = []) {
      const done = dayActivities.filter(a => a.done).length;
      const total = dayActivities.length;
      const percent = total ? Math.round((done / total) * 100) : 0;
      
      document.getElementById('progressBarFill').style.width = `${percent}%`;
      document.getElementById('progressText').textContent = `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: ${percent}% (${done}/${total})`;
    }

    function updateCalendarView() {
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏à‡∏∏‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
      const cells = document.querySelectorAll('#calendar .day');
      cells.forEach(cell => {
        const dateStr = cell.dataset.date;
        if (dateStr && activities[dateStr] && activities[dateStr].length > 0) {
          cell.classList.add('has-activity');
        } else {
          cell.classList.remove('has-activity');
        }
      });
    }
  </script>
</body>
</html>